{
"version":3,
"file":"module$node_modules$blockstack$lib$operations$safety.js",
"lineCount":7,
"mappings":"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",
"sources":["node_modules/blockstack/lib/operations/safety.js"],
"sourcesContent":["shadow$provide[\"module$node_modules$blockstack$lib$operations$safety\"] = function(global,process,require,module,exports,shadow$shims) {\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.safety = undefined;\n\nvar _slicedToArray = function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"]) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (Symbol.iterator in Object(arr)) { return sliceIterator(arr, i); } else { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); } }; }();\n\nvar _config = require('../config');\n\nfunction isNameValid() {\n  var fullyQualifiedName = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';\n\n  var NAME_PART_RULE = /^[a-z0-9\\-_+]+$/;\n  var LENGTH_MAX_NAME = 37;\n\n  if (!fullyQualifiedName || fullyQualifiedName.length > LENGTH_MAX_NAME) {\n    return Promise.resolve(false);\n  }\n  var nameParts = fullyQualifiedName.split('.');\n  if (nameParts.length !== 2) {\n    return Promise.resolve(false);\n  }\n  return Promise.resolve(nameParts.reduce(function (agg, namePart) {\n    if (!agg) {\n      return false;\n    } else {\n      return NAME_PART_RULE.test(namePart);\n    }\n  }, true));\n}\n\nfunction isNamespaceValid(namespaceID) {\n  var NAMESPACE_RULE = /^[a-z0-9\\-_]{1,19}$/;\n  return Promise.resolve(namespaceID.match(NAMESPACE_RULE) !== null);\n}\n\nfunction isNameAvailable(fullyQualifiedName) {\n  return _config.config.network.getNameInfo(fullyQualifiedName).then(function () {\n    return false;\n  }).catch(function (e) {\n    if (e.message === 'Name not found') {\n      return true;\n    } else {\n      throw e;\n    }\n  });\n}\n\nfunction isNamespaceAvailable(namespaceID) {\n  return _config.config.network.getNamespaceInfo(namespaceID).then(function () {\n    return false;\n  }).catch(function (e) {\n    if (e.message === 'Namespace not found') {\n      return true;\n    } else {\n      throw e;\n    }\n  });\n}\n\nfunction ownsName(fullyQualifiedName, ownerAddress) {\n  return _config.config.network.getNameInfo(fullyQualifiedName).then(function (nameInfo) {\n    return nameInfo.address === ownerAddress;\n  }).catch(function (e) {\n    if (e.message === 'Name not found') {\n      return false;\n    } else {\n      throw e;\n    }\n  });\n}\n\nfunction revealedNamespace(namespaceID, revealAddress) {\n  return _config.config.network.getNamespaceInfo(namespaceID).then(function (namespaceInfo) {\n    return namespaceInfo.recipient_address === revealAddress;\n  }).catch(function (e) {\n    if (e.message === 'Namespace not found') {\n      return false;\n    } else {\n      throw e;\n    }\n  });\n}\n\nfunction namespaceIsReady(namespaceID) {\n  return _config.config.network.getNamespaceInfo(namespaceID).then(function (namespaceInfo) {\n    return namespaceInfo.ready;\n  }).catch(function (e) {\n    if (e.message === 'Namespace not found') {\n      return false;\n    } else {\n      throw e;\n    }\n  });\n}\n\nfunction namespaceIsRevealed(namespaceID) {\n  return _config.config.network.getNamespaceInfo(namespaceID).then(function (namespaceInfo) {\n    return !namespaceInfo.ready;\n  }).catch(function (e) {\n    if (e.message === 'Namespace not found') {\n      return false;\n    } else {\n      throw e;\n    }\n  });\n}\n\nfunction isInGracePeriod(fullyQualifiedName) {\n  var network = _config.config.network;\n  return Promise.all([network.getNameInfo(fullyQualifiedName), network.getBlockHeight(), network.getGracePeriod(fullyQualifiedName)]).then(function (_ref) {\n    var _ref2 = _slicedToArray(_ref, 3),\n        nameInfo = _ref2[0],\n        blockHeight = _ref2[1],\n        gracePeriod = _ref2[2];\n\n    var expiresAt = nameInfo.expire_block;\n    return blockHeight >= expiresAt && blockHeight < gracePeriod + expiresAt;\n  }).catch(function (e) {\n    if (e.message === 'Name not found') {\n      return false;\n    } else {\n      throw e;\n    }\n  });\n}\n\nfunction addressCanReceiveName(address) {\n  return _config.config.network.getNamesOwned(address).then(function (names) {\n    return Promise.all(names.map(function (name) {\n      return isNameValid(name);\n    })).then(function (validNames) {\n      return validNames.filter(function (nameValid) {\n        return nameValid;\n      }).length < 25;\n    });\n  });\n}\n\nfunction isAccountSpendable(address, tokenType, blockHeight) {\n  return _config.config.network.getAccountStatus(address, tokenType).then(function (accountStatus) {\n    return accountStatus.transfer_send_block_id >= blockHeight;\n  });\n}\n\nvar safety = exports.safety = {\n  addressCanReceiveName: addressCanReceiveName,\n  isInGracePeriod: isInGracePeriod,\n  ownsName: ownsName,\n  isNameAvailable: isNameAvailable,\n  isNameValid: isNameValid,\n  isNamespaceValid: isNamespaceValid,\n  isNamespaceAvailable: isNamespaceAvailable,\n  revealedNamespace: revealedNamespace,\n  namespaceIsReady: namespaceIsReady,\n  namespaceIsRevealed: namespaceIsRevealed,\n  isAccountSpendable: isAccountSpendable\n};\n};"],
"names":["shadow$provide","global","process","require","module","exports","shadow$shims","isNameValid","fullyQualifiedName","arguments","length","undefined","NAME_PART_RULE","LENGTH_MAX_NAME","Promise","resolve","nameParts","split","reduce","agg","namePart","test","Object","defineProperty","value","safety","_slicedToArray","arr","i","Array","isArray","Symbol","iterator","_arr","_n","_d","_e","_i","_s","done","next","push","err","TypeError","_config","addressCanReceiveName","address","config","network","getNamesOwned","then","names","all","map","name","validNames","filter","nameValid","isInGracePeriod","getNameInfo","getBlockHeight","getGracePeriod","_ref","_ref2","blockHeight","gracePeriod","expiresAt","nameInfo","expire_block","catch","e","message","ownsName","ownerAddress","isNameAvailable","isNamespaceValid","namespaceID","match","NAMESPACE_RULE","isNamespaceAvailable","getNamespaceInfo","revealedNamespace","revealAddress","namespaceInfo","recipient_address","namespaceIsReady","ready","namespaceIsRevealed","isAccountSpendable","tokenType","getAccountStatus","accountStatus","transfer_send_block_id"]
}
