{
"version":3,
"file":"module$node_modules$diffie_hellman$lib$dh.js",
"lineCount":7,
"mappings":"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",
"sources":["node_modules/diffie-hellman/lib/dh.js"],
"sourcesContent":["shadow$provide[\"module$node_modules$diffie_hellman$lib$dh\"] = function(global,process,require,module,exports,shadow$shims) {\nvar BN = require('bn.js');\nvar MillerRabin = require('miller-rabin');\nvar millerRabin = new MillerRabin();\nvar TWENTYFOUR = new BN(24);\nvar ELEVEN = new BN(11);\nvar TEN = new BN(10);\nvar THREE = new BN(3);\nvar SEVEN = new BN(7);\nvar primes = require('./generatePrime');\nvar randomBytes = require('randombytes');\nmodule.exports = DH;\n\nfunction setPublicKey(pub, enc) {\n  enc = enc || 'utf8';\n  if (!Buffer.isBuffer(pub)) {\n    pub = new Buffer(pub, enc);\n  }\n  this._pub = new BN(pub);\n  return this;\n}\n\nfunction setPrivateKey(priv, enc) {\n  enc = enc || 'utf8';\n  if (!Buffer.isBuffer(priv)) {\n    priv = new Buffer(priv, enc);\n  }\n  this._priv = new BN(priv);\n  return this;\n}\n\nvar primeCache = {};\nfunction checkPrime(prime, generator) {\n  var gen = generator.toString('hex');\n  var hex = [gen, prime.toString(16)].join('_');\n  if (hex in primeCache) {\n    return primeCache[hex];\n  }\n  var error = 0;\n\n  if (prime.isEven() ||\n    !primes.simpleSieve ||\n    !primes.fermatTest(prime) ||\n    !millerRabin.test(prime)) {\n    //not a prime so +1\n    error += 1;\n\n    if (gen === '02' || gen === '05') {\n      // we'd be able to check the generator\n      // it would fail so +8\n      error += 8;\n    } else {\n      //we wouldn't be able to test the generator\n      // so +4\n      error += 4;\n    }\n    primeCache[hex] = error;\n    return error;\n  }\n  if (!millerRabin.test(prime.shrn(1))) {\n    //not a safe prime\n    error += 2;\n  }\n  var rem;\n  switch (gen) {\n    case '02':\n      if (prime.mod(TWENTYFOUR).cmp(ELEVEN)) {\n        // unsuidable generator\n        error += 8;\n      }\n      break;\n    case '05':\n      rem = prime.mod(TEN);\n      if (rem.cmp(THREE) && rem.cmp(SEVEN)) {\n        // prime mod 10 needs to equal 3 or 7\n        error += 8;\n      }\n      break;\n    default:\n      error += 4;\n  }\n  primeCache[hex] = error;\n  return error;\n}\n\nfunction DH(prime, generator, malleable) {\n  this.setGenerator(generator);\n  this.__prime = new BN(prime);\n  this._prime = BN.mont(this.__prime);\n  this._primeLen = prime.length;\n  this._pub = undefined;\n  this._priv = undefined;\n  this._primeCode = undefined;\n  if (malleable) {\n    this.setPublicKey = setPublicKey;\n    this.setPrivateKey = setPrivateKey;\n  } else {\n    this._primeCode = 8;\n  }\n}\nObject.defineProperty(DH.prototype, 'verifyError', {\n  enumerable: true,\n  get: function () {\n    if (typeof this._primeCode !== 'number') {\n      this._primeCode = checkPrime(this.__prime, this.__gen);\n    }\n    return this._primeCode;\n  }\n});\nDH.prototype.generateKeys = function () {\n  if (!this._priv) {\n    this._priv = new BN(randomBytes(this._primeLen));\n  }\n  this._pub = this._gen.toRed(this._prime).redPow(this._priv).fromRed();\n  return this.getPublicKey();\n};\n\nDH.prototype.computeSecret = function (other) {\n  other = new BN(other);\n  other = other.toRed(this._prime);\n  var secret = other.redPow(this._priv).fromRed();\n  var out = new Buffer(secret.toArray());\n  var prime = this.getPrime();\n  if (out.length < prime.length) {\n    var front = new Buffer(prime.length - out.length);\n    front.fill(0);\n    out = Buffer.concat([front, out]);\n  }\n  return out;\n};\n\nDH.prototype.getPublicKey = function getPublicKey(enc) {\n  return formatReturnValue(this._pub, enc);\n};\n\nDH.prototype.getPrivateKey = function getPrivateKey(enc) {\n  return formatReturnValue(this._priv, enc);\n};\n\nDH.prototype.getPrime = function (enc) {\n  return formatReturnValue(this.__prime, enc);\n};\n\nDH.prototype.getGenerator = function (enc) {\n  return formatReturnValue(this._gen, enc);\n};\n\nDH.prototype.setGenerator = function (gen, enc) {\n  enc = enc || 'utf8';\n  if (!Buffer.isBuffer(gen)) {\n    gen = new Buffer(gen, enc);\n  }\n  this.__gen = gen;\n  this._gen = new BN(gen);\n  return this;\n};\n\nfunction formatReturnValue(bn, enc) {\n  var buf = new Buffer(bn.toArray());\n  if (!enc) {\n    return buf;\n  } else {\n    return buf.toString(enc);\n  }\n}\n\n};"],
"names":["shadow$provide","global","process","require","module","exports","shadow$shims","setPublicKey","pub","enc","Buffer","isBuffer","_pub","BN","setPrivateKey","priv","_priv","DH","prime","generator","malleable","setGenerator","__prime","_prime","mont","_primeLen","length","_primeCode","undefined","formatReturnValue","bn","buf","toArray","toString","millerRabin","MillerRabin","TWENTYFOUR","ELEVEN","TEN","THREE","SEVEN","primes","randomBytes","primeCache","Object","defineProperty","prototype","enumerable","get","gen","__gen","hex","join","error","isEven","simpleSieve","fermatTest","test","shrn","mod","cmp","rem","generateKeys","DH.prototype.generateKeys","_gen","toRed","redPow","fromRed","getPublicKey","computeSecret","DH.prototype.computeSecret","other","secret","out","getPrime","front","fill","concat","DH.prototype.getPublicKey","getPrivateKey","DH.prototype.getPrivateKey","DH.prototype.getPrime","getGenerator","DH.prototype.getGenerator","DH.prototype.setGenerator"]
}
