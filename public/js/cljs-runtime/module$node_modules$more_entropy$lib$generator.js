shadow$provide.module$node_modules$more_entropy$lib$generator=function(global,process,require,module,exports,shadow$shims){(function(){var iced=require("module$node_modules$iced_runtime$lib$main");var __iced_k_noop=function(){};var Generator$jscomp$0=Generator$jscomp$0=function(){function Generator(opts){opts=opts||{};this.lazy_loop_delay=opts.lazy_loop_delay||30;this.loop_delay=opts.loop_delay||5;this.work_min=opts.work_min||1;this.auto_stop_bits=opts.auto_stop_bits||4096;this.max_bits_per_delta=
opts.max_bits_per_delta||4;this.auto_stop=opts.auto_stop?opts.auto_stop:!0;this.entropies=[];this.running=!0;this.is_generating=!1;this.timer_race_loop()}Generator.prototype.generate=function(bits_wanted,cb){var e,__iced_deferrals;var ___iced_passed_deferral=iced.findDeferral(arguments);this.is_generating=!0;this.running||this.resume();var harvested_bits=0;var res=[];(function(_this){return function(__iced_k$jscomp$1){var _results=[];var _while=function(__iced_k$jscomp$0){var _break=function(){return __iced_k$jscomp$0(_results)};
var _continue=function(){return iced.trampoline(function(){return _while(__iced_k$jscomp$0)})};var _next=function(__iced_next_arg){_results.push(__iced_next_arg);return _continue()};if(harvested_bits<bits_wanted)(function(__iced_k){if(_this.entropies.length)return e=_this.entropies.splice(0,1)[0],harvested_bits+=e[1],__iced_k(res.push(e[0]));__iced_deferrals=new iced.Deferrals(__iced_k,{parent:___iced_passed_deferral,filename:"/Users/chris/git/more-entropy/src/generator.iced",funcname:"Generator.generate"});
_this.delay(__iced_deferrals.defer({lineno:28}));__iced_deferrals._fulfill()})(_next);else return _break()};_while(__iced_k$jscomp$1)}})(this)(function(_this){return function(){_this.auto_stop&&_this.stop();_this.is_generating=!1;return cb(res)}}(this))};Generator.prototype.stop=function(){return this.running=!1};Generator.prototype.resume=function(){this.running=!0;return this.timer_race_loop()};Generator.prototype.reset=function(){this.entropies=[];return this.total_bits=0};Generator.prototype.count_unused_bits=
function(){var _len;var bits=0;var _ref=this.entropies;var _i=0;for(_len=_ref.length;_i<_len;_i++){var e=_ref[_i];bits+=e[1]}return bits};Generator.prototype.delay=function(cb){var __iced_deferrals;var ___iced_passed_deferral=iced.findDeferral(arguments);var delay=this.is_generating?this.loop_delay:this.lazy_loop_delay;(function(_this){return function(__iced_k){__iced_deferrals=new iced.Deferrals(__iced_k,{parent:___iced_passed_deferral,filename:"/Users/chris/git/more-entropy/src/generator.iced",
funcname:"Generator.delay"});setTimeout(__iced_deferrals.defer({lineno:50}),delay);__iced_deferrals._fulfill()}})(this)(function(_this){return function(){return cb()}}(this))};Generator.prototype.timer_race_loop=function(){var ___iced_passed_deferral=iced.findDeferral(arguments);this._last_count=null;var _results=[];var _while=function(_this){var count,delta,entropy,v,__iced_deferrals;return function(__iced_k){var _break=function(){return __iced_k(_results)};var _continue=function(){return iced.trampoline(function(){return _while(__iced_k)})};
var _next=function(__iced_next_arg){_results.push(__iced_next_arg);return _continue()};if(_this.running)_this.count_unused_bits()<_this.auto_stop_bits&&(count=_this.millisecond_count(),null!=_this._last_count&&(delta=count-_this._last_count)&&(entropy=Math.floor(_this.log_2(Math.abs(delta))),entropy=Math.min(_this.max_bits_per_delta,entropy),v=[delta,entropy],_this.entropies.push(v)),_this._last_count=count),__iced_deferrals=new iced.Deferrals(_next,{parent:___iced_passed_deferral,filename:"/Users/chris/git/more-entropy/src/generator.iced",
funcname:"Generator.timer_race_loop"}),_this.delay(__iced_deferrals.defer({lineno:64})),__iced_deferrals._fulfill();else return _break()}}(this);_while(__iced_k_noop)};Generator.prototype.log_2=function(x){return Math.log(x)/Math.LN2};Generator.prototype.millisecond_count=function(){var i;var d=Date.now();for(i=0;Date.now()<d+this.work_min+1;)i++;return i};return Generator}();"undefined"!==typeof window&&null!==window&&(window.Generator=Generator$jscomp$0);"undefined"!==typeof exports&&null!==exports&&
(exports.Generator=Generator$jscomp$0)}).call(this)}
//# sourceMappingURL=module$node_modules$more_entropy$lib$generator.js.map
