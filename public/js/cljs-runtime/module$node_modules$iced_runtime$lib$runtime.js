shadow$provide.module$node_modules$iced_runtime$lib$runtime=function(global,process,require,module,exports,shadow$shims){(function(){var exceptionHandler,stackWalk,trampoline,__slice=[].slice;var C=require("module$node_modules$iced_runtime$lib$const");var make_defer_return=function(obj,defer_args,id,trace_template,multi){var k;var trace={};for(k in trace_template){var v=trace_template[k];trace[k]=v}trace[C.lineno]=null!=defer_args?defer_args[C.lineno]:void 0;trace_template=function(){var _ref;var inner_args=
1<=arguments.length?__slice.call(arguments,0):[];null!=defer_args&&null!=(_ref=defer_args.assign_fn)&&_ref.apply(null,inner_args);return obj?(inner_args=obj,multi||(obj=null),inner_args._fulfill(id,trace)):warn("overused deferral at "+_trace_to_string(trace))};trace_template[C.trace]=trace;return trace_template};var __c=0;var tick_counter=function(mod){__c++;return 0===__c%mod?(__c=0,!0):!1};var __active_trace=null;var _trace_to_string=function(tr){return""+(tr[C.funcname]||"\x3canonymous\x3e")+" ("+
tr[C.filename]+":"+(tr[C.lineno]+1)+")"};var warn=function(m){return"undefined"!==typeof console&&null!==console?console.error("ICED warning: "+m):void 0};exports.trampoline=trampoline=function(fn){return tick_counter(500)?null!=("undefined"!==typeof process&&null!==process?process.nextTick:void 0)?process.nextTick(fn):setTimeout(fn):fn()};exports.Deferrals=function(){function Deferrals(k,trace){this.trace=trace;this.continuation=k;this.count=1;this.ret=null}Deferrals.prototype._call=function(trace){return this.continuation?
(__active_trace=trace,trace=this.continuation,this.continuation=null,trace(this.ret)):warn("Entered dead await at "+_trace_to_string(trace))};Deferrals.prototype._fulfill=function(id,trace){if(!(0<--this.count))return trampoline(function(_this){return function(){return _this._call(trace)}}(this))};Deferrals.prototype.defer=function(args){this.count++;return make_defer_return(this,args,null,this.trace)};return Deferrals}();exports.findDeferral=function(args){var _len;var _i=0;for(_len=args.length;_i<
_len;_i++){var a=args[_i];if(null!=a&&a[C.trace])return a}return null};exports.Rendezvous=function(){function Rendezvous(){this.completed=[];this.waiters=[];this.defer_id=0}var RvId=function(){function RvId(rv,id,multi){this.rv=rv;this.id=id;this.multi=multi}RvId.prototype.defer=function(defer_args){return this.rv._defer_with_id(this.id,defer_args,this.multi)};return RvId}();Rendezvous.prototype.wait=function(cb){if(this.completed.length){var x=this.completed.shift();return cb(x)}return this.waiters.push(cb)};
Rendezvous.prototype.defer=function(defer_args){var id=this.defer_id++;return this._defer_with_id(id,defer_args)};Rendezvous.prototype.id=function(i,multi){return new RvId(this,i,!!multi)};Rendezvous.prototype._fulfill=function(id,trace){return this.waiters.length?(trace=this.waiters.shift(),trace(id)):this.completed.push(id)};Rendezvous.prototype._defer_with_id=function(id,defer_args,multi){this.count++;return make_defer_return(this,defer_args,id,{},multi)};return Rendezvous}();exports.stackWalk=
stackWalk=function(cb){var tr,_ref;var ret=[];for(tr=cb?cb[C.trace]:__active_trace;tr;)cb="   at "+_trace_to_string(tr),ret.push(cb),tr=null!=tr?null!=(_ref=tr[C.parent])?_ref[C.trace]:void 0:void 0;return ret};exports.exceptionHandler=exceptionHandler=function(err,logger){logger||(logger=console.error);logger(err.stack);err=stackWalk();if(err.length)return logger("Iced 'stack' trace (w/ real line numbers):"),logger(err.join("\n"))};exports.catchExceptions=function(logger){return"undefined"!==typeof process&&
null!==process?process.on("uncaughtException",function(err){exceptionHandler(err,logger);return process.exit(1)}):void 0}}).call(this)}
//# sourceMappingURL=module$node_modules$iced_runtime$lib$runtime.js.map
