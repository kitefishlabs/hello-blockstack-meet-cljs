{
"version":3,
"file":"module$node_modules$jsontokens$lib$signer.js",
"lineCount":6,
"mappings":"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",
"sources":["node_modules/jsontokens/lib/signer.js"],
"sourcesContent":["shadow$provide[\"module$node_modules$jsontokens$lib$signer\"] = function(global,process,require,module,exports,shadow$shims) {\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.TokenSigner = undefined;\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nexports.createUnsecuredToken = createUnsecuredToken;\n\nvar _base64url = require('base64url');\n\nvar _base64url2 = _interopRequireDefault(_base64url);\n\nvar _cryptoClients = require('./cryptoClients');\n\nvar _decode = require('./decode');\n\nvar _decode2 = _interopRequireDefault(_decode);\n\nvar _errors = require('./errors');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction createSigningInput(payload, header) {\n    var tokenParts = [];\n\n    // add in the header\n    var encodedHeader = _base64url2.default.encode(JSON.stringify(header));\n    tokenParts.push(encodedHeader);\n\n    // add in the payload\n    var encodedPayload = _base64url2.default.encode(JSON.stringify(payload));\n    tokenParts.push(encodedPayload);\n\n    // prepare the message\n    var signingInput = tokenParts.join('.');\n\n    // return the signing input\n    return signingInput;\n}\n\nfunction createUnsecuredToken(payload) {\n    var header = { typ: 'JWT', alg: 'none' };\n    return createSigningInput(payload, header) + '.';\n}\n\nvar TokenSigner = exports.TokenSigner = function () {\n    function TokenSigner(signingAlgorithm, rawPrivateKey) {\n        _classCallCheck(this, TokenSigner);\n\n        if (!(signingAlgorithm && rawPrivateKey)) {\n            throw new _errors.MissingParametersError('a signing algorithm and private key are required');\n        }\n        if (typeof signingAlgorithm !== 'string') {\n            throw 'signing algorithm parameter must be a string';\n        }\n        signingAlgorithm = signingAlgorithm.toUpperCase();\n        if (!_cryptoClients.cryptoClients.hasOwnProperty(signingAlgorithm)) {\n            throw 'invalid signing algorithm';\n        }\n        this.tokenType = 'JWT';\n        this.cryptoClient = _cryptoClients.cryptoClients[signingAlgorithm];\n        this.rawPrivateKey = rawPrivateKey;\n    }\n\n    _createClass(TokenSigner, [{\n        key: 'header',\n        value: function header() {\n            return { typ: this.tokenType, alg: this.cryptoClient.algorithmName };\n        }\n    }, {\n        key: 'sign',\n        value: function sign(payload) {\n            var expanded = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n\n            // prepare the message to be signed\n            var signingInput = createSigningInput(payload, this.header());\n            var signingInputHash = this.cryptoClient.createHash(signingInput);\n\n            // sign the message and add in the signature\n            var signature = this.cryptoClient.signHash(signingInputHash, this.rawPrivateKey);\n\n            if (expanded) {\n                return {\n                    \"header\": [_base64url2.default.encode(JSON.stringify(this.header()))],\n                    \"payload\": JSON.stringify(payload),\n                    \"signature\": [signature]\n                };\n            } else {\n                return [signingInput, signature].join('.');\n            }\n        }\n    }]);\n\n    return TokenSigner;\n}();\n};"],
"names":["shadow$provide","global","process","require","module","exports","shadow$shims","createSigningInput","payload","header","tokenParts","encodedHeader","_base64url2","default","encode","JSON","stringify","push","encodedPayload","join","signingInput","Object","defineProperty","value","TokenSigner","undefined","_createClass","defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","key","Constructor","protoProps","staticProps","prototype","createUnsecuredToken","typ","alg","_base64url","__esModule","_cryptoClients","_errors","signingAlgorithm","rawPrivateKey","instance","TypeError","MissingParametersError","toUpperCase","cryptoClients","hasOwnProperty","tokenType","cryptoClient","algorithmName","sign","expanded","arguments","signingInputHash","createHash","signature","signHash"]
}
