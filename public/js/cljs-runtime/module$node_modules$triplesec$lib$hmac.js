shadow$provide.module$node_modules$triplesec$lib$hmac=function(global,process,require,module,exports,shadow$shims){(function(){var __hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);ctor.prototype=parent.prototype;child.prototype=new ctor;child.__super__=parent.prototype;return child};var iced=require("module$node_modules$iced_runtime$lib$main");var SHA512=require("module$node_modules$triplesec$lib$sha512").SHA512;
var SHA256=require("module$node_modules$triplesec$lib$sha256").SHA256;var util=require("module$node_modules$triplesec$lib$util");var HMAC=function(){function HMAC(key,klass){var _ref;null==klass&&(klass=SHA512);this.key=key.clone();this.hasher=new klass;this.hasherBlockSize=this.hasher.blockSize;this.hasherBlockSizeBytes=4*this.hasherBlockSize;this.key.sigBytes>this.hasherBlockSizeBytes&&(this.key=this.hasher.finalize(this.key));this.key.clamp();this._oKey=this.key.clone();this._iKey=this.key.clone();
key=klass=0;for(_ref=this.hasherBlockSize;0<=_ref?klass<_ref:klass>_ref;key=0<=_ref?++klass:--klass)this._oKey.words[key]^=1549556828,this._iKey.words[key]^=909522486;this._oKey.sigBytes=this._iKey.sigBytes=this.hasherBlockSizeBytes;this.reset()}HMAC.outputSize=64;HMAC.prototype.outputSize=HMAC.outputSize;HMAC.prototype.get_output_size=function(){return this.hasher.output_size};HMAC.prototype.reset=function(){return this.hasher.reset().update(this._iKey)};HMAC.prototype.update=function(wa){this.hasher.update(wa);
return this};HMAC.prototype.finalize=function(wa){wa=this.hasher.finalize(wa);this.hasher.reset();var innerHash2=this._oKey.clone().concat(wa);var out=this.hasher.finalize(innerHash2);wa.scrub();innerHash2.scrub();return out};HMAC.prototype.scrub=function(){this.key.scrub();this._iKey.scrub();return this._oKey.scrub()};return HMAC}();exports.HMAC_SHA256=function(_super){function HMAC_SHA256(key){HMAC_SHA256.__super__.constructor.call(this,key,SHA256)}__extends(HMAC_SHA256,_super);return HMAC_SHA256}(HMAC);
exports.HMAC=HMAC;exports.sign=function(_arg){var key=_arg.key;var input=_arg.input;_arg=new HMAC(key,_arg.hash_class);input=_arg.finalize(input.clamp());_arg.scrub();return input};exports.bulk_sign=function(_arg,cb){var res,__iced_deferrals;var ___iced_passed_deferral=iced.findDeferral(arguments);var key=_arg.key;var input=_arg.input;var progress_hook=_arg.progress_hook;var klass=_arg.klass;var what=_arg.what;klass||(klass=HMAC);what||(what="hmac_sha512");var eng=new klass(key);input.clamp();var slice_args=
{update:function(lo,hi){return eng.update(input.slice(lo,hi))},finalize:function(){return eng.finalize()},default_n:1E3*eng.hasherBlockSize};(function(_this){return function(__iced_k){__iced_deferrals=new iced.Deferrals(__iced_k,{parent:___iced_passed_deferral,filename:"/Users/max/src/keybase/triplesec/src/hmac.iced"});util.bulk(input.sigBytes,slice_args,{what:what,progress_hook:progress_hook,cb:__iced_deferrals.defer({assign_fn:function(){return function(JSCompiler_OptimizeArgumentsArray_p7){return res=
JSCompiler_OptimizeArgumentsArray_p7}}(),lineno:137})});__iced_deferrals._fulfill()}})(this)(function(_this){return function(){eng.scrub();return cb(res)}}(this))}}).call(this)}
//# sourceMappingURL=module$node_modules$triplesec$lib$hmac.js.map
