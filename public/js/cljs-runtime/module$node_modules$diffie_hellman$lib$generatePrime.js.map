{
"version":3,
"file":"module$node_modules$diffie_hellman$lib$generatePrime.js",
"lineCount":4,
"mappings":"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",
"sources":["node_modules/diffie-hellman/lib/generatePrime.js"],
"sourcesContent":["shadow$provide[\"module$node_modules$diffie_hellman$lib$generatePrime\"] = function(global,process,require,module,exports,shadow$shims) {\nvar randomBytes = require('randombytes');\nmodule.exports = findPrime;\nfindPrime.simpleSieve = simpleSieve;\nfindPrime.fermatTest = fermatTest;\nvar BN = require('bn.js');\nvar TWENTYFOUR = new BN(24);\nvar MillerRabin = require('miller-rabin');\nvar millerRabin = new MillerRabin();\nvar ONE = new BN(1);\nvar TWO = new BN(2);\nvar FIVE = new BN(5);\nvar SIXTEEN = new BN(16);\nvar EIGHT = new BN(8);\nvar TEN = new BN(10);\nvar THREE = new BN(3);\nvar SEVEN = new BN(7);\nvar ELEVEN = new BN(11);\nvar FOUR = new BN(4);\nvar TWELVE = new BN(12);\nvar primes = null;\n\nfunction _getPrimes() {\n  if (primes !== null)\n    return primes;\n\n  var limit = 0x100000;\n  var res = [];\n  res[0] = 2;\n  for (var i = 1, k = 3; k < limit; k += 2) {\n    var sqrt = Math.ceil(Math.sqrt(k));\n    for (var j = 0; j < i && res[j] <= sqrt; j++)\n      if (k % res[j] === 0)\n        break;\n\n    if (i !== j && res[j] <= sqrt)\n      continue;\n\n    res[i++] = k;\n  }\n  primes = res;\n  return res;\n}\n\nfunction simpleSieve(p) {\n  var primes = _getPrimes();\n\n  for (var i = 0; i < primes.length; i++)\n    if (p.modn(primes[i]) === 0) {\n      if (p.cmpn(primes[i]) === 0) {\n        return true;\n      } else {\n        return false;\n      }\n    }\n\n  return true;\n}\n\nfunction fermatTest(p) {\n  var red = BN.mont(p);\n  return TWO.toRed(red).redPow(p.subn(1)).fromRed().cmpn(1) === 0;\n}\n\nfunction findPrime(bits, gen) {\n  if (bits < 16) {\n    // this is what openssl does\n    if (gen === 2 || gen === 5) {\n      return new BN([0x8c, 0x7b]);\n    } else {\n      return new BN([0x8c, 0x27]);\n    }\n  }\n  gen = new BN(gen);\n\n  var num, n2;\n\n  while (true) {\n    num = new BN(randomBytes(Math.ceil(bits / 8)));\n    while (num.bitLength() > bits) {\n      num.ishrn(1);\n    }\n    if (num.isEven()) {\n      num.iadd(ONE);\n    }\n    if (!num.testn(1)) {\n      num.iadd(TWO);\n    }\n    if (!gen.cmp(TWO)) {\n      while (num.mod(TWENTYFOUR).cmp(ELEVEN)) {\n        num.iadd(FOUR);\n      }\n    } else if (!gen.cmp(FIVE)) {\n      while (num.mod(TEN).cmp(THREE)) {\n        num.iadd(FOUR);\n      }\n    }\n    n2 = num.shrn(1);\n    if (simpleSieve(n2) && simpleSieve(num) &&\n      fermatTest(n2) && fermatTest(num) &&\n      millerRabin.test(n2) && millerRabin.test(num)) {\n      return num;\n    }\n  }\n\n}\n\n};"],
"names":["shadow$provide","global","process","require","module","exports","shadow$shims","simpleSieve","p","primes","res","i","k","limit","sqrt","Math","ceil","j","length","modn","cmpn","fermatTest","red","BN","mont","TWO","toRed","redPow","subn","fromRed","findPrime","bits","gen","num","n2","randomBytes","bitLength","ishrn","isEven","iadd","ONE","testn","cmp","mod","TWENTYFOUR","ELEVEN","FOUR","FIVE","TEN","THREE","shrn","millerRabin","test","MillerRabin"]
}
