shadow$provide.module$node_modules$asn1_DOT_js$lib$asn1$decoders$der=function(global,process,require,module,exports,shadow$shims){function DERDecoder(entity){this.enc="der";this.name=entity.name;this.entity=entity;this.tree=new DERNode;this.tree._init(entity.body)}function DERNode(parent){base.Node.call(this,"der",parent)}function derDecodeTag(buf,fail){var tag=buf.readUInt8(fail);if(buf.isError(tag))return tag;var cls=der.tagClass[tag>>6],primitive=0===(tag&32);if(31===(tag&31)){var oct=tag;for(tag=
0;128===(oct&128);){oct=buf.readUInt8(fail);if(buf.isError(oct))return oct;tag<<=7;tag|=oct&127}}else tag&=31;return{cls:cls,primitive:primitive,tag:tag,tagStr:der.tag[tag]}}function derDecodeLen(buf,primitive,fail){var len=buf.readUInt8(fail);if(buf.isError(len))return len;if(!primitive&&128===len)return null;if(0===(len&128))return len;primitive=len&127;if(4<primitive)return buf.error("length octect is too long");for(var i=len=0;i<primitive;i++){len<<=8;var j=buf.readUInt8(fail);if(buf.isError(j))return j;
len|=j}return len}global=require("module$node_modules$inherits$inherits_browser");require=require("module$node_modules$asn1_DOT_js$lib$asn1");var base=require.base,bignum=require.bignum,der=require.constants.der;module.exports=DERDecoder;DERDecoder.prototype.decode=function(data,options){data instanceof base.DecoderBuffer||(data=new base.DecoderBuffer(data,options));return this.tree._decode(data,options)};global(DERNode,base.Node);DERNode.prototype._peekTag=function(buffer,tag,any){if(buffer.isEmpty())return!1;
var state=buffer.save(),decodedTag=derDecodeTag(buffer,'Failed to peek tag: "'+tag+'"');if(buffer.isError(decodedTag))return decodedTag;buffer.restore(state);return decodedTag.tag===tag||decodedTag.tagStr===tag||decodedTag.tagStr+"of"===tag||any};DERNode.prototype._decodeTag=function(buffer,tag,any){var decodedTag=derDecodeTag(buffer,'Failed to decode tag of "'+tag+'"');if(buffer.isError(decodedTag))return decodedTag;var len=derDecodeLen(buffer,decodedTag.primitive,'Failed to get length of "'+tag+
'"');if(buffer.isError(len))return len;if(!any&&decodedTag.tag!==tag&&decodedTag.tagStr!==tag&&decodedTag.tagStr+"of"!==tag)return buffer.error('Failed to match tag: "'+tag+'"');if(decodedTag.primitive||null!==len)return buffer.skip(len,'Failed to match body of: "'+tag+'"');any=buffer.save();len=this._skipUntilEnd(buffer,'Failed to skip indefinite length body: "'+this.tag+'"');if(buffer.isError(len))return len;len=buffer.offset-any.offset;buffer.restore(any);return buffer.skip(len,'Failed to match body of: "'+
tag+'"')};DERNode.prototype._skipUntilEnd=function(buffer,fail){for(;;){var tag=derDecodeTag(buffer,fail);if(buffer.isError(tag))return tag;var len=derDecodeLen(buffer,tag.primitive,fail);if(buffer.isError(len))return len;len=tag.primitive||null!==len?buffer.skip(len):this._skipUntilEnd(buffer,fail);if(buffer.isError(len))return len;if("end"===tag.tagStr)break}};DERNode.prototype._decodeList=function(buffer,tag,decoder,options){for(tag=[];!buffer.isEmpty();){var possibleEnd=this._peekTag(buffer,"end");
if(buffer.isError(possibleEnd))return possibleEnd;var res=decoder.decode(buffer,"der",options);if(buffer.isError(res)&&possibleEnd)break;tag.push(res)}return tag};DERNode.prototype._decodeStr=function(buffer,tag){if("bitstr"===tag)return tag=buffer.readUInt8(),buffer.isError(tag)?tag:{unused:tag,data:buffer.raw()};if("bmpstr"===tag){tag=buffer.raw();if(1===tag.length%2)return buffer.error("Decoding of string type: bmpstr length mismatch");buffer="";for(var i=0;i<tag.length/2;i++)buffer+=String.fromCharCode(tag.readUInt16BE(2*
i));return buffer}return"numstr"===tag?(tag=buffer.raw().toString("ascii"),this._isNumstr(tag)?tag:buffer.error("Decoding of string type: numstr unsupported characters")):"octstr"===tag||"objDesc"===tag?buffer.raw():"printstr"===tag?(tag=buffer.raw().toString("ascii"),this._isPrintstr(tag)?tag:buffer.error("Decoding of string type: printstr unsupported characters")):/str$/.test(tag)?buffer.raw().toString():buffer.error("Decoding of string type: "+tag+" unsupported")};DERNode.prototype._decodeObjid=
function(buffer,values,relative){for(var identifiers=[],ident=0;!buffer.isEmpty();){var subident=buffer.readUInt8();ident<<=7;ident|=subident&127;0===(subident&128)&&(identifiers.push(ident),ident=0)}subident&128&&identifiers.push(ident);buffer=identifiers[0]/40|0;ident=identifiers[0]%40;relative=relative?identifiers:[buffer,ident].concat(identifiers.slice(1));values&&(identifiers=values[relative.join(" ")],void 0===identifiers&&(identifiers=values[relative.join(".")]),void 0!==identifiers&&(relative=
identifiers));return relative};DERNode.prototype._decodeTime=function(buffer,tag){var str=buffer.raw().toString();if("gentime"===tag){buffer=str.slice(0,4)|0;tag=str.slice(4,6)|0;var day=str.slice(6,8)|0,hour=str.slice(8,10)|0,min=str.slice(10,12)|0;str=str.slice(12,14)|0}else if("utctime"===tag)buffer=str.slice(0,2)|0,tag=str.slice(2,4)|0,day=str.slice(4,6)|0,hour=str.slice(6,8)|0,min=str.slice(8,10)|0,str=str.slice(10,12)|0,buffer=70>buffer?2E3+buffer:1900+buffer;else return buffer.error("Decoding "+
tag+" time is not supported yet");return Date.UTC(buffer,tag-1,day,hour,min,str,0)};DERNode.prototype._decodeNull=function(buffer){return null};DERNode.prototype._decodeBool=function(buffer){var res=buffer.readUInt8();return buffer.isError(res)?res:0!==res};DERNode.prototype._decodeInt=function(buffer,values){buffer=buffer.raw();buffer=new bignum(buffer);values&&(buffer=values[buffer.toString(10)]||buffer);return buffer};DERNode.prototype._use=function(entity,obj){"function"===typeof entity&&(entity=
entity(obj));return entity._getDecoder("der").tree}}
//# sourceMappingURL=module$node_modules$asn1_DOT_js$lib$asn1$decoders$der.js.map
