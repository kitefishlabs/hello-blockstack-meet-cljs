shadow$provide.module$node_modules$bip66$index=function(global,process,require,module,exports,shadow$shims){var Buffer=require("module$node_modules$safe_buffer$index").Buffer;module.exports={check:function(buffer){if(8>buffer.length||72<buffer.length||48!==buffer[0]||buffer[1]!==buffer.length-2||2!==buffer[2])return!1;var lenR=buffer[3];if(0===lenR||5+lenR>=buffer.length||2!==buffer[4+lenR])return!1;var lenS=buffer[5+lenR];return 0===lenS||6+lenR+lenS!==buffer.length||buffer[4]&128||1<lenR&&0===buffer[4]&&
!(buffer[5]&128)||buffer[lenR+6]&128||1<lenS&&0===buffer[lenR+6]&&!(buffer[lenR+7]&128)?!1:!0},decode:function(buffer){if(8>buffer.length)throw Error("DER sequence length is too short");if(72<buffer.length)throw Error("DER sequence length is too long");if(48!==buffer[0])throw Error("Expected DER sequence");if(buffer[1]!==buffer.length-2)throw Error("DER sequence length is invalid");if(2!==buffer[2])throw Error("Expected DER integer");var lenR=buffer[3];if(0===lenR)throw Error("R length is zero");
if(5+lenR>=buffer.length)throw Error("R length is too long");if(2!==buffer[4+lenR])throw Error("Expected DER integer (2)");var lenS=buffer[5+lenR];if(0===lenS)throw Error("S length is zero");if(6+lenR+lenS!==buffer.length)throw Error("S length is invalid");if(buffer[4]&128)throw Error("R value is negative");if(1<lenR&&0===buffer[4]&&!(buffer[5]&128))throw Error("R value excessively padded");if(buffer[lenR+6]&128)throw Error("S value is negative");if(1<lenS&&0===buffer[lenR+6]&&!(buffer[lenR+7]&128))throw Error("S value excessively padded");
return{r:buffer.slice(4,4+lenR),s:buffer.slice(6+lenR)}},encode:function(r,s){var lenR=r.length,lenS=s.length;if(0===lenR)throw Error("R length is zero");if(0===lenS)throw Error("S length is zero");if(33<lenR)throw Error("R length is too long");if(33<lenS)throw Error("S length is too long");if(r[0]&128)throw Error("R value is negative");if(s[0]&128)throw Error("S value is negative");if(1<lenR&&0===r[0]&&!(r[1]&128))throw Error("R value excessively padded");if(1<lenS&&0===s[0]&&!(s[1]&128))throw Error("S value excessively padded");
lenS=Buffer.allocUnsafe(6+lenR+lenS);lenS[0]=48;lenS[1]=lenS.length-2;lenS[2]=2;lenS[3]=r.length;r.copy(lenS,4);lenS[4+lenR]=2;lenS[5+lenR]=s.length;s.copy(lenS,6+lenR);return lenS}}}
//# sourceMappingURL=module$node_modules$bip66$index.js.map
