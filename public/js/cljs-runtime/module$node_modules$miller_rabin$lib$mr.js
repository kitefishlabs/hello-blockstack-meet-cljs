shadow$provide.module$node_modules$miller_rabin$lib$mr=function(global,process,require,module,exports,shadow$shims){function MillerRabin(rand){this.rand=rand||new brorand.Rand}var bn=require("module$node_modules$bn_DOT_js$lib$bn"),brorand=require("module$node_modules$brorand$index");module.exports=MillerRabin;MillerRabin.create=function(rand){return new MillerRabin(rand)};MillerRabin.prototype._randbelow=function(n){var len=n.bitLength();len=Math.ceil(len/8);do var a=new bn(this.rand.generate(len));
while(0<=a.cmp(n));return a};MillerRabin.prototype._randrange=function(start,stop){stop=stop.sub(start);return start.add(this._randbelow(stop))};MillerRabin.prototype.test=function(n,k,cb){var len=n.bitLength(),red=bn.mont(n),rone=(new bn(1)).toRed(red);k||(k=Math.max(1,len/48|0));len=n.subn(1);for(var s=0;!len.testn(s);s++);n=n.shrn(s);for(var rn1=len.toRed(red);0<k;k--){var a=this._randrange(new bn(2),len);cb&&cb(a);a=a.toRed(red).redPow(n);if(0!==a.cmp(rone)&&0!==a.cmp(rn1)){for(var i=1;i<s;i++){a=
a.redSqr();if(0===a.cmp(rone))return!1;if(0===a.cmp(rn1))break}if(i===s)return!1}}return!0};MillerRabin.prototype.getDivisor=function(n,k){var len=n.bitLength(),red=bn.mont(n),rone=(new bn(1)).toRed(red);k||(k=Math.max(1,len/48|0));len=n.subn(1);for(var s=0;!len.testn(s);s++);for(var d=n.shrn(s),rn1=len.toRed(red);0<k;k--){var a=this._randrange(new bn(2),len),g=n.gcd(a);if(0!==g.cmpn(1))return g;a=a.toRed(red).redPow(d);if(0!==a.cmp(rone)&&0!==a.cmp(rn1)){for(g=1;g<s;g++){a=a.redSqr();if(0===a.cmp(rone))return a.fromRed().subn(1).gcd(n);
if(0===a.cmp(rn1))break}if(g===s)return a=a.redSqr(),a.fromRed().subn(1).gcd(n)}}return!1}}
//# sourceMappingURL=module$node_modules$miller_rabin$lib$mr.js.map
