{
"version":3,
"file":"module$node_modules$browserify_aes$authCipher.js",
"lineCount":6,
"mappings":"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",
"sources":["node_modules/browserify-aes/authCipher.js"],
"sourcesContent":["shadow$provide[\"module$node_modules$browserify_aes$authCipher\"] = function(global,process,require,module,exports,shadow$shims) {\nvar aes = require('./aes')\nvar Buffer = require('safe-buffer').Buffer\nvar Transform = require('cipher-base')\nvar inherits = require('inherits')\nvar GHASH = require('./ghash')\nvar xor = require('buffer-xor')\nvar incr32 = require('./incr32')\n\nfunction xorTest (a, b) {\n  var out = 0\n  if (a.length !== b.length) out++\n\n  var len = Math.min(a.length, b.length)\n  for (var i = 0; i < len; ++i) {\n    out += (a[i] ^ b[i])\n  }\n\n  return out\n}\n\nfunction calcIv (self, iv, ck) {\n  if (iv.length === 12) {\n    self._finID = Buffer.concat([iv, Buffer.from([0, 0, 0, 1])])\n    return Buffer.concat([iv, Buffer.from([0, 0, 0, 2])])\n  }\n  var ghash = new GHASH(ck)\n  var len = iv.length\n  var toPad = len % 16\n  ghash.update(iv)\n  if (toPad) {\n    toPad = 16 - toPad\n    ghash.update(Buffer.alloc(toPad, 0))\n  }\n  ghash.update(Buffer.alloc(8, 0))\n  var ivBits = len * 8\n  var tail = Buffer.alloc(8)\n  tail.writeUIntBE(ivBits, 0, 8)\n  ghash.update(tail)\n  self._finID = ghash.state\n  var out = Buffer.from(self._finID)\n  incr32(out)\n  return out\n}\nfunction StreamCipher (mode, key, iv, decrypt) {\n  Transform.call(this)\n\n  var h = Buffer.alloc(4, 0)\n\n  this._cipher = new aes.AES(key)\n  var ck = this._cipher.encryptBlock(h)\n  this._ghash = new GHASH(ck)\n  iv = calcIv(this, iv, ck)\n\n  this._prev = Buffer.from(iv)\n  this._cache = Buffer.allocUnsafe(0)\n  this._secCache = Buffer.allocUnsafe(0)\n  this._decrypt = decrypt\n  this._alen = 0\n  this._len = 0\n  this._mode = mode\n\n  this._authTag = null\n  this._called = false\n}\n\ninherits(StreamCipher, Transform)\n\nStreamCipher.prototype._update = function (chunk) {\n  if (!this._called && this._alen) {\n    var rump = 16 - (this._alen % 16)\n    if (rump < 16) {\n      rump = Buffer.alloc(rump, 0)\n      this._ghash.update(rump)\n    }\n  }\n\n  this._called = true\n  var out = this._mode.encrypt(this, chunk)\n  if (this._decrypt) {\n    this._ghash.update(chunk)\n  } else {\n    this._ghash.update(out)\n  }\n  this._len += chunk.length\n  return out\n}\n\nStreamCipher.prototype._final = function () {\n  if (this._decrypt && !this._authTag) throw new Error('Unsupported state or unable to authenticate data')\n\n  var tag = xor(this._ghash.final(this._alen * 8, this._len * 8), this._cipher.encryptBlock(this._finID))\n  if (this._decrypt && xorTest(tag, this._authTag)) throw new Error('Unsupported state or unable to authenticate data')\n\n  this._authTag = tag\n  this._cipher.scrub()\n}\n\nStreamCipher.prototype.getAuthTag = function getAuthTag () {\n  if (this._decrypt || !Buffer.isBuffer(this._authTag)) throw new Error('Attempting to get auth tag in unsupported state')\n\n  return this._authTag\n}\n\nStreamCipher.prototype.setAuthTag = function setAuthTag (tag) {\n  if (!this._decrypt) throw new Error('Attempting to set auth tag in unsupported state')\n\n  this._authTag = tag\n}\n\nStreamCipher.prototype.setAAD = function setAAD (buf) {\n  if (this._called) throw new Error('Attempting to set AAD in unsupported state')\n\n  this._ghash.update(buf)\n  this._alen += buf.length\n}\n\nmodule.exports = StreamCipher\n\n};"],
"names":["shadow$provide","global","process","require","module","exports","shadow$shims","StreamCipher","mode","key","iv","decrypt","Transform","call","h","Buffer","alloc","_cipher","aes","AES","ck","encryptBlock","_ghash","GHASH","length","self","_finID","concat","from","ghash","len","toPad","update","ivBits","tail","writeUIntBE","state","out","incr32","_prev","_cache","allocUnsafe","_secCache","_decrypt","_len","_alen","_mode","_authTag","_called","inherits","xor","prototype","_update","StreamCipher.prototype._update","chunk","rump","encrypt","_final","StreamCipher.prototype._final","Error","tag","final","a","b","Math","min","i","scrub","getAuthTag","StreamCipher.prototype.getAuthTag","isBuffer","setAuthTag","StreamCipher.prototype.setAuthTag","setAAD","StreamCipher.prototype.setAAD","buf"]
}
