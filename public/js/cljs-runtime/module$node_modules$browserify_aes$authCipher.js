shadow$provide.module$node_modules$browserify_aes$authCipher=function(global,process,require,module,exports,shadow$shims){function StreamCipher(mode,key,iv,decrypt){Transform.call(this);var h=Buffer.alloc(4,0);this._cipher=new aes.AES(key);h=this._cipher.encryptBlock(h);this._ghash=new GHASH(h);key=iv;if(12===key.length)this._finID=Buffer.concat([key,Buffer.from([0,0,0,1])]),iv=Buffer.concat([key,Buffer.from([0,0,0,2])]);else{iv=new GHASH(h);h=key.length;var toPad=h%16;iv.update(key);toPad&&iv.update(Buffer.alloc(16-
toPad,0));iv.update(Buffer.alloc(8,0));key=8*h;h=Buffer.alloc(8);h.writeUIntBE(key,0,8);iv.update(h);this._finID=iv.state;iv=Buffer.from(this._finID);incr32(iv)}this._prev=Buffer.from(iv);this._cache=Buffer.allocUnsafe(0);this._secCache=Buffer.allocUnsafe(0);this._decrypt=decrypt;this._len=this._alen=0;this._mode=mode;this._authTag=null;this._called=!1}var aes=require("module$node_modules$browserify_aes$aes"),Buffer=require("module$node_modules$safe_buffer$index").Buffer,Transform=require("module$node_modules$cipher_base$index");
global=require("module$node_modules$inherits$inherits_browser");var GHASH=require("module$node_modules$browserify_aes$ghash"),xor=require("module$node_modules$buffer_xor$index"),incr32=require("module$node_modules$browserify_aes$incr32");global(StreamCipher,Transform);StreamCipher.prototype._update=function(chunk){if(!this._called&&this._alen){var rump=16-this._alen%16;16>rump&&(rump=Buffer.alloc(rump,0),this._ghash.update(rump))}this._called=!0;rump=this._mode.encrypt(this,chunk);this._decrypt?this._ghash.update(chunk):
this._ghash.update(rump);this._len+=chunk.length;return rump};StreamCipher.prototype._final=function(){if(this._decrypt&&!this._authTag)throw Error("Unsupported state or unable to authenticate data");var tag=xor(this._ghash.final(8*this._alen,8*this._len),this._cipher.encryptBlock(this._finID)),JSCompiler_temp;if(JSCompiler_temp=this._decrypt){JSCompiler_temp=this._authTag;var out=0;tag.length!==JSCompiler_temp.length&&out++;for(var len=Math.min(tag.length,JSCompiler_temp.length),i=0;i<len;++i)out+=
tag[i]^JSCompiler_temp[i];JSCompiler_temp=out}if(JSCompiler_temp)throw Error("Unsupported state or unable to authenticate data");this._authTag=tag;this._cipher.scrub()};StreamCipher.prototype.getAuthTag=function(){if(this._decrypt||!Buffer.isBuffer(this._authTag))throw Error("Attempting to get auth tag in unsupported state");return this._authTag};StreamCipher.prototype.setAuthTag=function(tag){if(!this._decrypt)throw Error("Attempting to set auth tag in unsupported state");this._authTag=tag};StreamCipher.prototype.setAAD=
function(buf){if(this._called)throw Error("Attempting to set AAD in unsupported state");this._ghash.update(buf);this._alen+=buf.length};module.exports=StreamCipher}
//# sourceMappingURL=module$node_modules$browserify_aes$authCipher.js.map
