shadow$provide.module$node_modules$triplesec$lib$prng=function(global,process,require,module,exports,shadow$shims){(function(){var m,_ref,_ref1;var iced=require("module$node_modules$iced_runtime$lib$main");var more_entropy=require("module$node_modules$more_entropy$lib$main");var ADRBG=require("module$node_modules$triplesec$lib$drbg").ADRBG;var WordArray=require("module$node_modules$triplesec$lib$wordarray").WordArray;var XOR=require("module$node_modules$triplesec$lib$combine").XOR;var util=require("module$node_modules$triplesec$lib$util");
var _browser_rng_primitive=null;var browser_rng=function(n){n=new Uint8Array(n);_browser_rng_primitive(n);return new shadow$shims.Buffer(n)};_browser_rng_primitive=null!=(m="undefined"!==typeof window&&null!==window?null!=(_ref=window.crypto)?_ref.getRandomValues:void 0:void 0)?m.bind(window.crypto):null!=(m="undefined"!==typeof window&&null!==window?null!=(_ref1=window.msCrypto)?_ref1.getRandomValues:void 0:void 0)?m.bind(window.msCrypto):null;if(null!=_browser_rng_primitive)var _native_rng=browser_rng;
else try{var rng=require("crypto").rng;null!=rng&&(_native_rng=rng)}catch(_error){}var native_rng=function(x){if(null==_native_rng)throw Error('No rng found; tried requiring "crypto" and window.crypto');return _native_rng(x)};var PRNG=function(){function PRNG(){this.meg=new more_entropy.Generator;this.adrbg=new ADRBG(function(_this){return function(n,cb){return _this.gen_seed(n,cb)}}(this),XOR.sign)}PRNG.prototype.now_to_buffer=function(){var buf=Date.now();var ms=buf%1E3;var s=Math.floor(buf/1E3);
buf=new shadow$shims.Buffer(8);buf.writeUInt32BE(s,0);buf.writeUInt32BE(ms,4);return buf};PRNG.prototype.gen_seed=function(nbits,cb){var b,cat,wa,words,__iced_deferrals;var ___iced_passed_deferral=iced.findDeferral(arguments);var nbytes=nbits/8;var bufs=[];bufs.push(this.now_to_buffer());(function(_this){return function(__iced_k){__iced_deferrals=new iced.Deferrals(__iced_k,{parent:___iced_passed_deferral,filename:"/Users/max/src/keybase/triplesec/src/prng.iced",funcname:"PRNG.gen_seed"});_this.meg.generate(nbits,
__iced_deferrals.defer({assign_fn:function(){return function(JSCompiler_OptimizeArgumentsArray_p16){return words=JSCompiler_OptimizeArgumentsArray_p16}}(),lineno:83}));__iced_deferrals._fulfill()}})(this)(function(_this){return function(){var _len;bufs.push(_this.now_to_buffer());bufs.push(new shadow$shims.Buffer(words));bufs.push(native_rng(nbytes));bufs.push(_this.now_to_buffer());cat=shadow$shims.Buffer.concat(bufs);wa=WordArray.from_buffer(cat);util.scrub_buffer(cat);var _i=0;for(_len=bufs.length;_i<
_len;_i++)b=bufs[_i],util.scrub_buffer(b);return cb(wa)}}(this))};PRNG.prototype.generate=function(n,cb){return this.adrbg.generate(n,cb)};return PRNG}();var _prng=null;exports.PRNG=PRNG;exports.generate=function(n,cb){null==_prng&&(_prng=new PRNG);return _prng.generate(n,cb)};exports.native_rng=native_rng}).call(this)}
//# sourceMappingURL=module$node_modules$triplesec$lib$prng.js.map
