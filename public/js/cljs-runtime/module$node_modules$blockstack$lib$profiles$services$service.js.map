{
"version":3,
"file":"module$node_modules$blockstack$lib$profiles$services$service.js",
"lineCount":6,
"mappings":"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",
"sources":["node_modules/blockstack/lib/profiles/services/service.js"],
"sourcesContent":["shadow$provide[\"module$node_modules$blockstack$lib$profiles$services$service\"] = function(global,process,require,module,exports,shadow$shims) {\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.Service = undefined;\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nrequire('cross-fetch/polyfill');\n\nvar _serviceUtils = require('./serviceUtils');\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar Service = exports.Service = function () {\n  function Service() {\n    _classCallCheck(this, Service);\n  }\n\n  _createClass(Service, null, [{\n    key: 'validateProof',\n    value: function validateProof(proof, ownerAddress) {\n      var _this = this;\n\n      var name = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;\n\n      var proofUrl = void 0;\n      return Promise.resolve().then(function () {\n        proofUrl = _this.getProofUrl(proof);\n        return fetch(proofUrl);\n      }).then(function (res) {\n        if (res.status !== 200) {\n          throw new Error('Proof url ' + proofUrl + ' returned unexpected http status ' + res.status + '.\\n              Unable to validate proof.');\n        }\n        return res.text();\n      }).then(function (text) {\n        // Validate identity in provided proof body/tags if required\n        if (_this.shouldValidateIdentityInBody() && proof.identifier !== _this.getProofIdentity(text)) {\n          return proof;\n        }\n        var proofText = _this.getProofStatement(text);\n        proof.valid = (0, _serviceUtils.containsValidProofStatement)(proofText, name) || (0, _serviceUtils.containsValidAddressProofStatement)(proofText, ownerAddress);\n        return proof;\n      }).catch(function (error) {\n        console.error(error);\n        proof.valid = false;\n        return proof;\n      });\n    }\n  }, {\n    key: 'getBaseUrls',\n    value: function getBaseUrls() {\n      return [];\n    }\n  }, {\n    key: 'getProofIdentity',\n    value: function getProofIdentity(searchText) {\n      return searchText;\n    }\n  }, {\n    key: 'getProofStatement',\n    value: function getProofStatement(searchText) {\n      return searchText;\n    }\n  }, {\n    key: 'shouldValidateIdentityInBody',\n    value: function shouldValidateIdentityInBody() {\n      return false;\n    }\n  }, {\n    key: 'prefixScheme',\n    value: function prefixScheme(proofUrl) {\n      if (!proofUrl.startsWith('https://') && !proofUrl.startsWith('http://')) {\n        return 'https://' + proofUrl;\n      } else if (proofUrl.startsWith('http://')) {\n        return proofUrl.replace('http://', 'https://');\n      } else {\n        return proofUrl;\n      }\n    }\n  }, {\n    key: 'getProofUrl',\n    value: function getProofUrl(proof) {\n      var baseUrls = this.getBaseUrls();\n\n      var proofUrl = proof.proof_url.toLowerCase();\n      proofUrl = this.prefixScheme(proofUrl);\n\n      for (var i = 0; i < baseUrls.length; i++) {\n        var requiredPrefix = ('' + baseUrls[i] + proof.identifier).toLowerCase();\n        if (proofUrl.startsWith(requiredPrefix)) {\n          return proofUrl;\n        }\n      }\n      throw new Error('Proof url ' + proof.proof_url + ' is not valid for service ' + proof.service);\n    }\n  }]);\n\n  return Service;\n}();\n};"],
"names":["shadow$provide","global","process","require","module","exports","shadow$shims","Object","defineProperty","value","Service","undefined","_createClass","defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","key","Constructor","protoProps","staticProps","prototype","_serviceUtils","instance","TypeError","validateProof","proof","ownerAddress","_this","name","arguments","proofUrl","Promise","resolve","then","getProofUrl","fetch","res","status","Error","text","shouldValidateIdentityInBody","identifier","getProofIdentity","proofText","getProofStatement","valid","containsValidProofStatement","containsValidAddressProofStatement","catch","error","console","getBaseUrls","searchText","prefixScheme","startsWith","replace","baseUrls","proof_url","toLowerCase","requiredPrefix","service"]
}
