shadow$provide.module$node_modules$asn1_DOT_js$lib$asn1$base$node=function(global,process,require,module,exports,shadow$shims){function Node(enc,parent){var state={};this._baseState=state;state.enc=enc;state.parent=parent||null;state.children=null;state.tag=null;state.args=null;state.reverseArgs=null;state.choice=null;state.optional=!1;state.any=!1;state.obj=!1;state.use=null;state.useDecoder=null;state.key=null;state["default"]=null;state.explicit=null;state.implicit=null;state.contains=null;state.parent||
(state.children=[],this._wrap())}var Reporter=require("module$node_modules$asn1_DOT_js$lib$asn1$base$index").Reporter,EncoderBuffer=require("module$node_modules$asn1_DOT_js$lib$asn1$base$index").EncoderBuffer,DecoderBuffer=require("module$node_modules$asn1_DOT_js$lib$asn1$base$index").DecoderBuffer,assert=require("module$node_modules$minimalistic_assert$index");global="seq seqof set setof objid bool gentime utctime null_ enum int objDesc bitstr bmpstr charstr genstr graphstr ia5str iso646str numstr octstr printstr t61str unistr utf8str videostr".split(" ");
var methods="key obj use optional explicit implicit def choice any contains".split(" ").concat(global);module.exports=Node;var stateProps="enc parent children tag args reverseArgs choice optional any obj use alteredUse key default explicit implicit contains".split(" ");Node.prototype.clone=function(){var state=this._baseState,cstate={};stateProps.forEach(function(prop){cstate[prop]=state[prop]});var res=new this.constructor(cstate.parent);res._baseState=cstate;return res};Node.prototype._wrap=function(){var state=
this._baseState;methods.forEach(function(method){this[method]=function(){var clone=new this.constructor(this);state.children.push(clone);return clone[method].apply(clone,arguments)}},this)};Node.prototype._init=function(body){var state=this._baseState;assert(null===state.parent);body.call(this);state.children=state.children.filter(function(child){return child._baseState.parent===this},this);assert.equal(state.children.length,1,"Root node can have only one child")};Node.prototype._useArgs=function(args){var state=
this._baseState,children=args.filter(function(arg){return arg instanceof this.constructor},this);args=args.filter(function(arg){return!(arg instanceof this.constructor)},this);0!==children.length&&(assert(null===state.children),state.children=children,children.forEach(function(child){child._baseState.parent=this},this));0!==args.length&&(assert(null===state.args),state.args=args,state.reverseArgs=args.map(function(arg){if("object"!==typeof arg||arg.constructor!==Object)return arg;var res={};Object.keys(arg).forEach(function(key){key==
(key|0)&&(key|=0);res[arg[key]]=key});return res}))};"_peekTag _decodeTag _use _decodeStr _decodeObjid _decodeTime _decodeNull _decodeInt _decodeBool _decodeList _encodeComposite _encodeStr _encodeObjid _encodeTime _encodeNull _encodeInt _encodeBool".split(" ").forEach(function(method){Node.prototype[method]=function(){throw Error(method+" not implemented for encoding: "+this._baseState.enc);}});global.forEach(function(tag){Node.prototype[tag]=function(){var state=this._baseState,args=Array.prototype.slice.call(arguments);
assert(null===state.tag);state.tag=tag;this._useArgs(args);return this}});Node.prototype.use=function(item){assert(item);var state=this._baseState;assert(null===state.use);state.use=item;return this};Node.prototype.optional=function(){this._baseState.optional=!0;return this};Node.prototype.def=function(val){var state=this._baseState;assert(null===state["default"]);state["default"]=val;state.optional=!0;return this};Node.prototype.explicit=function(num){var state=this._baseState;assert(null===state.explicit&&
null===state.implicit);state.explicit=num;return this};Node.prototype.implicit=function(num){var state=this._baseState;assert(null===state.explicit&&null===state.implicit);state.implicit=num;return this};Node.prototype.obj=function(){var state=this._baseState,args=Array.prototype.slice.call(arguments);state.obj=!0;0!==args.length&&this._useArgs(args);return this};Node.prototype.key=function(newKey){var state=this._baseState;assert(null===state.key);state.key=newKey;return this};Node.prototype.any=
function(){this._baseState.any=!0;return this};Node.prototype.choice=function(obj){var state=this._baseState;assert(null===state.choice);state.choice=obj;this._useArgs(Object.keys(obj).map(function(key){return obj[key]}));return this};Node.prototype.contains=function(item){var state=this._baseState;assert(null===state.use);state.contains=item;return this};Node.prototype._decode=function(input,options){var state=this._baseState;if(null===state.parent)return input.wrapResult(state.children[0]._decode(input,
options));var result=state["default"],present=!0,prevKey=null;null!==state.key&&(prevKey=input.enterKey(state.key));if(state.optional){var tag=null;null!==state.explicit?tag=state.explicit:null!==state.implicit?tag=state.implicit:null!==state.tag&&(tag=state.tag);if(null!==tag||state.any){if(present=this._peekTag(input,tag,state.any),input.isError(present))return present}else{var save=input.save();try{null===state.choice?this._decodeGeneric(state.tag,input,options):this._decodeChoice(input,options),
present=!0}catch(e){present=!1}input.restore(save)}}var prevObj;state.obj&&present&&(prevObj=input.enterObject());if(present){if(null!==state.explicit){tag=this._decodeTag(input,state.explicit);if(input.isError(tag))return tag;input=tag}tag=input.offset;if(null===state.use&&null===state.choice){state.any&&(save=input.save());var body=this._decodeTag(input,null!==state.implicit?state.implicit:state.tag,state.any);if(input.isError(body))return body;state.any?result=input.raw(save):input=body}options&&
options.track&&null!==state.tag&&options.track(input.path(),tag,input.length,"tagged");options&&options.track&&null!==state.tag&&options.track(input.path(),input.offset,input.length,"content");state.any||(result=null===state.choice?this._decodeGeneric(state.tag,input,options):this._decodeChoice(input,options));if(input.isError(result))return result;state.any||null!==state.choice||null===state.children||state.children.forEach(function(child){child._decode(input,options)});!state.contains||"octstr"!==
state.tag&&"bitstr"!==state.tag||(result=new DecoderBuffer(result),result=this._getUse(state.contains,input._reporterState.obj)._decode(result,options))}state.obj&&present&&(result=input.leaveObject(prevObj));null===state.key||null===result&&!0!==present?null!==prevKey&&input.exitKey(prevKey):input.leaveKey(prevKey,state.key,result);return result};Node.prototype._decodeGeneric=function(tag,input,options){var state=this._baseState;return"seq"===tag||"set"===tag?null:"seqof"===tag||"setof"===tag?this._decodeList(input,
tag,state.args[0],options):/str$/.test(tag)?this._decodeStr(input,tag,options):"objid"===tag&&state.args?this._decodeObjid(input,state.args[0],state.args[1],options):"objid"===tag?this._decodeObjid(input,null,null,options):"gentime"===tag||"utctime"===tag?this._decodeTime(input,tag,options):"null_"===tag?this._decodeNull(input,options):"bool"===tag?this._decodeBool(input,options):"objDesc"===tag?this._decodeStr(input,tag,options):"int"===tag||"enum"===tag?this._decodeInt(input,state.args&&state.args[0],
options):null!==state.use?this._getUse(state.use,input._reporterState.obj)._decode(input,options):input.error("unknown tag: "+tag)};Node.prototype._getUse=function(entity,obj){var state=this._baseState;state.useDecoder=this._use(entity,obj);assert(null===state.useDecoder._baseState.parent);state.useDecoder=state.useDecoder._baseState.children[0];state.implicit!==state.useDecoder._baseState.implicit&&(state.useDecoder=state.useDecoder.clone(),state.useDecoder._baseState.implicit=state.implicit);return state.useDecoder};
Node.prototype._decodeChoice=function(input,options){var state=this._baseState,result=null,match=!1;Object.keys(state.choice).some(function(key){var save=input.save(),node=state.choice[key];try{var value=node._decode(input,options);if(input.isError(value))return!1;result={type:key,value:value};match=!0}catch(e){return input.restore(save),!1}return!0},this);return match?result:input.error("Choice not matched")};Node.prototype._createEncoderBuffer=function(data){return new EncoderBuffer(data,this.reporter)};
Node.prototype._encode=function(data,reporter,parent){var state=this._baseState;if(null===state["default"]||state["default"]!==data)if(data=this._encodeValue(data,reporter,parent),void 0!==data&&!this._skipDefault(data,reporter,parent))return data};Node.prototype._encodeValue=function(data,reporter,parent){var state=this._baseState;if(null===state.parent)return state.children[0]._encode(data,reporter||new Reporter);var result=null;this.reporter=reporter;if(state.optional&&void 0===data)if(null!==
state["default"])data=state["default"];else return;var content=null,primitive=!1;if(state.any)result=this._createEncoderBuffer(data);else if(state.choice)result=this._encodeChoice(data,reporter);else if(state.contains)content=this._getUse(state.contains,parent)._encode(data,reporter),primitive=!0;else if(state.children)content=state.children.map(function(child){if("null_"===child._baseState.tag)return child._encode(null,reporter,data);if(null===child._baseState.key)return reporter.error("Child should have a key");
var prevKey=reporter.enterKey(child._baseState.key);if("object"!==typeof data)return reporter.error("Child expected, but input is not object");child=child._encode(data[child._baseState.key],reporter,data);reporter.leaveKey(prevKey);return child},this).filter(function(child){return child}),content=this._createEncoderBuffer(content);else if("seqof"===state.tag||"setof"===state.tag){if(!state.args||1!==state.args.length)return reporter.error("Too many args for : "+state.tag);if(!Array.isArray(data))return reporter.error("seqof/setof, but data is not Array");
content=this.clone();content._baseState.implicit=null;content=this._createEncoderBuffer(data.map(function(item){return this._getUse(this._baseState.args[0],data)._encode(item,reporter)},content))}else null!==state.use?result=this._getUse(state.use,parent)._encode(data,reporter):(content=this._encodePrimitive(state.tag,data),primitive=!0);if(!state.any&&null===state.choice){parent=null!==state.implicit?state.implicit:state.tag;var cls=null===state.implicit?"universal":"context";null===parent?null===
state.use&&reporter.error("Tag could be omitted only for .use()"):null===state.use&&(result=this._encodeComposite(parent,primitive,cls,content))}null!==state.explicit&&(result=this._encodeComposite(state.explicit,!1,"context",result));return result};Node.prototype._encodeChoice=function(data,reporter){var state=this._baseState,node=state.choice[data.type];node||assert(!1,data.type+" not found in "+JSON.stringify(Object.keys(state.choice)));return node._encode(data.value,reporter)};Node.prototype._encodePrimitive=
function(tag,data){var state=this._baseState;if(/str$/.test(tag))return this._encodeStr(data,tag);if("objid"===tag&&state.args)return this._encodeObjid(data,state.reverseArgs[0],state.args[1]);if("objid"===tag)return this._encodeObjid(data,null,null);if("gentime"===tag||"utctime"===tag)return this._encodeTime(data,tag);if("null_"===tag)return this._encodeNull();if("int"===tag||"enum"===tag)return this._encodeInt(data,state.args&&state.reverseArgs[0]);if("bool"===tag)return this._encodeBool(data);
if("objDesc"===tag)return this._encodeStr(data,tag);throw Error("Unsupported tag: "+tag);};Node.prototype._isNumstr=function(str){return/^[0-9 ]*$/.test(str)};Node.prototype._isPrintstr=function(str){return/^[A-Za-z0-9 '\(\)\+,\-\.\/:=\?]*$/.test(str)}}
//# sourceMappingURL=module$node_modules$asn1_DOT_js$lib$asn1$base$node.js.map
