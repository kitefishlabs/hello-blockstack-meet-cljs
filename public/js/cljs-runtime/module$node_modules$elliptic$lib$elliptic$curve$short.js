shadow$provide.module$node_modules$elliptic$lib$elliptic$curve$short=function(global,process,require,module,exports,shadow$shims){function ShortCurve(conf){Base.call(this,"short",conf);this.a=(new BN(conf.a,16)).toRed(this.red);this.b=(new BN(conf.b,16)).toRed(this.red);this.tinv=this.two.redInvm();this.zeroA=0===this.a.fromRed().cmpn(0);this.threeA=0===this.a.fromRed().sub(this.p).cmpn(-3);this.endo=this._getEndomorphism(conf);this._endoWnafT1=Array(4);this._endoWnafT2=Array(4)}function Point(curve,
x,y,isRed){Base.BasePoint.call(this,curve,"affine");null===x&&null===y?(this.y=this.x=null,this.inf=!0):(this.x=new BN(x,16),this.y=new BN(y,16),isRed&&(this.x.forceRed(this.curve.red),this.y.forceRed(this.curve.red)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.inf=!1)}function JPoint(curve,x,y,z){Base.BasePoint.call(this,curve,"jacobian");null===x&&null===y&&null===z?(this.y=this.x=this.curve.one,this.z=new BN(0)):(this.x=new BN(x,16),
this.y=new BN(y,16),this.z=new BN(z,16));this.x.red||(this.x=this.x.toRed(this.curve.red));this.y.red||(this.y=this.y.toRed(this.curve.red));this.z.red||(this.z=this.z.toRed(this.curve.red));this.zOne=this.z===this.curve.one}global=require("module$node_modules$elliptic$lib$elliptic$curve$index");process=require("module$node_modules$elliptic$lib$elliptic");var BN=require("module$node_modules$bn_DOT_js$lib$bn");require=require("module$node_modules$inherits$inherits_browser");var Base=global.base,assert=
process.utils.assert;require(ShortCurve,Base);module.exports=ShortCurve;ShortCurve.prototype._getEndomorphism=function(conf){if(this.zeroA&&this.g&&this.n&&1===this.p.modn(3)){if(conf.beta)var beta=(new BN(conf.beta,16)).toRed(this.red);else beta=this._getEndoRoots(this.p),beta=0>beta[0].cmp(beta[1])?beta[0]:beta[1],beta=beta.toRed(this.red);if(conf.lambda)var lambda=new BN(conf.lambda,16);else lambda=this._getEndoRoots(this.n),0===this.g.mul(lambda[0]).x.cmp(this.g.x.redMul(beta))?lambda=lambda[0]:
(lambda=lambda[1],assert(0===this.g.mul(lambda).x.cmp(this.g.x.redMul(beta))));conf=conf.basis?conf.basis.map(function(vec){return{a:new BN(vec.a,16),b:new BN(vec.b,16)}}):this._getEndoBasis(lambda);return{beta:beta,lambda:lambda,basis:conf}}};ShortCurve.prototype._getEndoRoots=function(num){var red=num===this.p?this.red:BN.mont(num),tinv=(new BN(2)).toRed(red).redInvm();num=tinv.redNeg();tinv=(new BN(3)).toRed(red).redNeg().redSqrt().redMul(tinv);red=num.redAdd(tinv).fromRed();num=num.redSub(tinv).fromRed();
return[red,num]};ShortCurve.prototype._getEndoBasis=function(lambda){for(var aprxSqrt=this.n.ushrn(Math.floor(this.n.bitLength()/2)),v=this.n.clone(),x1=new BN(1),y1=new BN(0),x2=new BN(0),y2=new BN(1),a0,b0,a1,b1,b2,prevR,i=0,r;0!==lambda.cmpn(0);){var q=v.div(lambda);r=v.sub(q.mul(lambda));b2=x2.sub(q.mul(x1));q=y2.sub(q.mul(y1));if(!a1&&0>r.cmp(aprxSqrt))a0=prevR.neg(),b0=x1,a1=r.neg(),b1=b2;else if(a1&&2===++i)break;prevR=r;v=lambda;lambda=r;x2=x1;x1=b2;y2=y1;y1=q}aprxSqrt=r.neg();prevR=a1.sqr().add(b1.sqr());
0<=aprxSqrt.sqr().add(b2.sqr()).cmp(prevR)&&(aprxSqrt=a0,b2=b0);a1.negative&&(a1=a1.neg(),b1=b1.neg());aprxSqrt.negative&&(aprxSqrt=aprxSqrt.neg(),b2=b2.neg());return[{a:a1,b:b1},{a:aprxSqrt,b:b2}]};ShortCurve.prototype._endoSplit=function(k){var basis=this.endo.basis,v1=basis[0],v2=basis[1],c1=v2.b.mul(k).divRound(this.n),c2=v1.b.neg().mul(k).divRound(this.n);basis=c1.mul(v1.a);var p2=c2.mul(v2.a);v1=c1.mul(v1.b);v2=c2.mul(v2.b);k=k.sub(basis).sub(p2);basis=v1.add(v2).neg();return{k1:k,k2:basis}};
ShortCurve.prototype.pointFromX=function(x,odd){x=new BN(x,16);x.red||(x=x.toRed(this.red));var y2=x.redSqr().redMul(x).redIAdd(x.redMul(this.a)).redIAdd(this.b),y=y2.redSqrt();if(0!==y.redSqr().redSub(y2).cmp(this.zero))throw Error("invalid point");y2=y.fromRed().isOdd();if(odd&&!y2||!odd&&y2)y=y.redNeg();return this.point(x,y)};ShortCurve.prototype.validate=function(point){if(point.inf)return!0;var x=point.x;point=point.y;var ax=this.a.redMul(x);x=x.redSqr().redMul(x).redIAdd(ax).redIAdd(this.b);
return 0===point.redSqr().redISub(x).cmpn(0)};ShortCurve.prototype._endoWnafMulAdd=function(points,coeffs,jacobianResult){for(var npoints=this._endoWnafT1,ncoeffs=this._endoWnafT2,i=0;i<points.length;i++){var split=this._endoSplit(coeffs[i]),p=points[i],beta=p._getBeta();split.k1.negative&&(split.k1.ineg(),p=p.neg(!0));split.k2.negative&&(split.k2.ineg(),beta=beta.neg(!0));npoints[2*i]=p;npoints[2*i+1]=beta;ncoeffs[2*i]=split.k1;ncoeffs[2*i+1]=split.k2}points=this._wnafMulAdd(1,npoints,ncoeffs,2*
i,jacobianResult);for(coeffs=0;coeffs<2*i;coeffs++)npoints[coeffs]=null,ncoeffs[coeffs]=null;return points};require(Point,Base.BasePoint);ShortCurve.prototype.point=function(x,y,isRed){return new Point(this,x,y,isRed)};ShortCurve.prototype.pointFromJSON=function(obj,red){return Point.fromJSON(this,obj,red)};Point.prototype._getBeta=function(){if(this.curve.endo){var pre=this.precomputed;if(pre&&pre.beta)return pre.beta;var beta=this.curve.point(this.x.redMul(this.curve.endo.beta),this.y);if(pre){var curve=
this.curve,endoMul=function(p){return curve.point(p.x.redMul(curve.endo.beta),p.y)};pre.beta=beta;beta.precomputed={beta:null,naf:pre.naf&&{wnd:pre.naf.wnd,points:pre.naf.points.map(endoMul)},doubles:pre.doubles&&{step:pre.doubles.step,points:pre.doubles.points.map(endoMul)}}}return beta}};Point.prototype.toJSON=function(){return this.precomputed?[this.x,this.y,this.precomputed&&{doubles:this.precomputed.doubles&&{step:this.precomputed.doubles.step,points:this.precomputed.doubles.points.slice(1)},
naf:this.precomputed.naf&&{wnd:this.precomputed.naf.wnd,points:this.precomputed.naf.points.slice(1)}}]:[this.x,this.y]};Point.fromJSON=function(curve,obj$jscomp$0,red){function obj2point(obj){return curve.point(obj[0],obj[1],red)}"string"===typeof obj$jscomp$0&&(obj$jscomp$0=JSON.parse(obj$jscomp$0));var res=curve.point(obj$jscomp$0[0],obj$jscomp$0[1],red);if(!obj$jscomp$0[2])return res;obj$jscomp$0=obj$jscomp$0[2];res.precomputed={beta:null,doubles:obj$jscomp$0.doubles&&{step:obj$jscomp$0.doubles.step,
points:[res].concat(obj$jscomp$0.doubles.points.map(obj2point))},naf:obj$jscomp$0.naf&&{wnd:obj$jscomp$0.naf.wnd,points:[res].concat(obj$jscomp$0.naf.points.map(obj2point))}};return res};Point.prototype.inspect=function(){return this.isInfinity()?"\x3cEC Point Infinity\x3e":"\x3cEC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+"\x3e"};Point.prototype.isInfinity=function(){return this.inf};Point.prototype.add=function(p){if(this.inf)return p;if(p.inf)return this;
if(this.eq(p))return this.dbl();if(this.neg().eq(p)||0===this.x.cmp(p.x))return this.curve.point(null,null);var c=this.y.redSub(p.y);0!==c.cmpn(0)&&(c=c.redMul(this.x.redSub(p.x).redInvm()));p=c.redSqr().redISub(this.x).redISub(p.x);c=c.redMul(this.x.redSub(p)).redISub(this.y);return this.curve.point(p,c)};Point.prototype.dbl=function(){if(this.inf)return this;var ys1=this.y.redAdd(this.y);if(0===ys1.cmpn(0))return this.curve.point(null,null);var a=this.curve.a,x2=this.x.redSqr();ys1=ys1.redInvm();
x2=x2.redAdd(x2).redIAdd(x2).redIAdd(a).redMul(ys1);a=x2.redSqr().redISub(this.x.redAdd(this.x));x2=x2.redMul(this.x.redSub(a)).redISub(this.y);return this.curve.point(a,x2)};Point.prototype.getX=function(){return this.x.fromRed()};Point.prototype.getY=function(){return this.y.fromRed()};Point.prototype.mul=function(k){k=new BN(k,16);return this._hasDoubles(k)?this.curve._fixedNafMul(this,k):this.curve.endo?this.curve._endoWnafMulAdd([this],[k]):this.curve._wnafMul(this,k)};Point.prototype.mulAdd=
function(k1,p2,k2){p2=[this,p2];k1=[k1,k2];return this.curve.endo?this.curve._endoWnafMulAdd(p2,k1):this.curve._wnafMulAdd(1,p2,k1,2)};Point.prototype.jmulAdd=function(k1,p2,k2){p2=[this,p2];k1=[k1,k2];return this.curve.endo?this.curve._endoWnafMulAdd(p2,k1,!0):this.curve._wnafMulAdd(1,p2,k1,2,!0)};Point.prototype.eq=function(p){return this===p||this.inf===p.inf&&(this.inf||0===this.x.cmp(p.x)&&0===this.y.cmp(p.y))};Point.prototype.neg=function(_precompute){if(this.inf)return this;var res=this.curve.point(this.x,
this.y.redNeg());if(_precompute&&this.precomputed){_precompute=this.precomputed;var negate=function(p){return p.neg()};res.precomputed={naf:_precompute.naf&&{wnd:_precompute.naf.wnd,points:_precompute.naf.points.map(negate)},doubles:_precompute.doubles&&{step:_precompute.doubles.step,points:_precompute.doubles.points.map(negate)}}}return res};Point.prototype.toJ=function(){return this.inf?this.curve.jpoint(null,null,null):this.curve.jpoint(this.x,this.y,this.curve.one)};require(JPoint,Base.BasePoint);
ShortCurve.prototype.jpoint=function(x,y,z){return new JPoint(this,x,y,z)};JPoint.prototype.toP=function(){if(this.isInfinity())return this.curve.point(null,null);var zinv=this.z.redInvm(),zinv2=zinv.redSqr(),ax=this.x.redMul(zinv2);zinv=this.y.redMul(zinv2).redMul(zinv);return this.curve.point(ax,zinv)};JPoint.prototype.neg=function(){return this.curve.jpoint(this.x,this.y.redNeg(),this.z)};JPoint.prototype.add=function(p){if(this.isInfinity())return p;if(p.isInfinity())return this;var pz2=p.z.redSqr(),
z2=this.z.redSqr(),u1=this.x.redMul(pz2),u2=p.x.redMul(z2);pz2=this.y.redMul(pz2.redMul(p.z));z2=p.y.redMul(z2.redMul(this.z));u2=u1.redSub(u2);z2=pz2.redSub(z2);if(0===u2.cmpn(0))return 0!==z2.cmpn(0)?this.curve.jpoint(null,null,null):this.dbl();var h2=u2.redSqr(),h3=h2.redMul(u2);h2=u1.redMul(h2);u1=z2.redSqr().redIAdd(h3).redISub(h2).redISub(h2);pz2=z2.redMul(h2.redISub(u1)).redISub(pz2.redMul(h3));p=this.z.redMul(p.z).redMul(u2);return this.curve.jpoint(u1,pz2,p)};JPoint.prototype.mixedAdd=function(p){if(this.isInfinity())return p.toJ();
if(p.isInfinity())return this;var z2=this.z.redSqr(),u1=this.x,u2=p.x.redMul(z2),s1=this.y;p=p.y.redMul(z2).redMul(this.z);u2=u1.redSub(u2);p=s1.redSub(p);if(0===u2.cmpn(0))return 0!==p.cmpn(0)?this.curve.jpoint(null,null,null):this.dbl();var h2=u2.redSqr();z2=h2.redMul(u2);h2=u1.redMul(h2);u1=p.redSqr().redIAdd(z2).redISub(h2).redISub(h2);s1=p.redMul(h2.redISub(u1)).redISub(s1.redMul(z2));u2=this.z.redMul(u2);return this.curve.jpoint(u1,s1,u2)};JPoint.prototype.dblp=function(pow){if(0===pow||this.isInfinity())return this;
if(!pow)return this.dbl();if(this.curve.zeroA||this.curve.threeA){for(var r=this,i=0;i<pow;i++)r=r.dbl();return r}r=this.curve.a;var tinv=this.curve.tinv,jx=this.x;i=this.y;var jz=this.z,jz4=jz.redSqr().redSqr(),jyd=i.redAdd(i);for(i=0;i<pow;i++){var jx2=jx.redSqr(),jyd2=jyd.redSqr(),jyd4=jyd2.redSqr();jx2=jx2.redAdd(jx2).redIAdd(jx2).redIAdd(r.redMul(jz4));jyd2=jx.redMul(jyd2);jx=jx2.redSqr().redISub(jyd2.redAdd(jyd2));jyd2=jyd2.redISub(jx);jx2=jx2.redMul(jyd2);jx2=jx2.redIAdd(jx2).redISub(jyd4);
jz=jyd.redMul(jz);i+1<pow&&(jz4=jz4.redMul(jyd4));jyd=jx2}return this.curve.jpoint(jx,jyd.redMul(tinv),jz)};JPoint.prototype.dbl=function(){return this.isInfinity()?this:this.curve.zeroA?this._zeroDbl():this.curve.threeA?this._threeDbl():this._dbl()};JPoint.prototype._zeroDbl=function(){if(this.zOne){var nz=this.x.redSqr();var ny=this.y.redSqr();var nx=ny.redSqr();ny=this.x.redAdd(ny).redSqr().redISub(nz).redISub(nx);ny=ny.redIAdd(ny);nz=nz.redAdd(nz).redIAdd(nz);var t=nz.redSqr().redISub(ny).redISub(ny),
yyyy8=nx.redIAdd(nx);yyyy8=yyyy8.redIAdd(yyyy8);yyyy8=yyyy8.redIAdd(yyyy8);nx=t;ny=nz.redMul(ny.redISub(t)).redISub(yyyy8);nz=this.y.redAdd(this.y)}else nz=this.x.redSqr(),ny=this.y.redSqr(),nx=ny.redSqr(),ny=this.x.redAdd(ny).redSqr().redISub(nz).redISub(nx),ny=ny.redIAdd(ny),nz=nz.redAdd(nz).redIAdd(nz),t=nz.redSqr(),yyyy8=nx.redIAdd(nx),yyyy8=yyyy8.redIAdd(yyyy8),yyyy8=yyyy8.redIAdd(yyyy8),nx=t.redISub(ny).redISub(ny),ny=nz.redMul(ny.redISub(nx)).redISub(yyyy8),nz=this.y.redMul(this.z),nz=nz.redIAdd(nz);
return this.curve.jpoint(nx,ny,nz)};JPoint.prototype._threeDbl=function(){var nz;if(this.zOne){var nx=this.x.redSqr();var yy=this.y.redSqr();var ny=yy.redSqr();yy=this.x.redAdd(yy).redSqr().redISub(nx).redISub(ny);yy=yy.redIAdd(yy);var m=nx.redAdd(nx).redIAdd(nx).redIAdd(this.curve.a);nx=nz=m.redSqr().redISub(yy).redISub(yy);ny=ny.redIAdd(ny);ny=ny.redIAdd(ny);ny=ny.redIAdd(ny);ny=m.redMul(yy.redISub(nz)).redISub(ny);nz=this.y.redAdd(this.y)}else nz=this.z.redSqr(),yy=this.y.redSqr(),nx=this.x.redMul(yy),
ny=this.x.redSub(nz).redMul(this.x.redAdd(nz)),ny=ny.redAdd(ny).redIAdd(ny),m=nx.redIAdd(nx),m=m.redIAdd(m),nx=m.redAdd(m),nx=ny.redSqr().redISub(nx),nz=this.y.redAdd(this.z).redSqr().redISub(yy).redISub(nz),yy=yy.redSqr(),yy=yy.redIAdd(yy),yy=yy.redIAdd(yy),yy=yy.redIAdd(yy),ny=ny.redMul(m.redISub(nx)).redISub(yy);return this.curve.jpoint(nx,ny,nz)};JPoint.prototype._dbl=function(){var a=this.curve.a,jx=this.x,jy=this.y,jz=this.z,jz4=jz.redSqr().redSqr(),jx2=jx.redSqr(),jy2=jy.redSqr();a=jx2.redAdd(jx2).redIAdd(jx2).redIAdd(a.redMul(jz4));
jx=jx.redAdd(jx);jx=jx.redIAdd(jx);jz4=jx.redMul(jy2);jx=a.redSqr().redISub(jz4.redAdd(jz4));jz4=jz4.redISub(jx);jy2=jy2.redSqr();jy2=jy2.redIAdd(jy2);jy2=jy2.redIAdd(jy2);jy2=jy2.redIAdd(jy2);jy2=a.redMul(jz4).redISub(jy2);jy=jy.redAdd(jy).redMul(jz);return this.curve.jpoint(jx,jy2,jy)};JPoint.prototype.trpl=function(){if(!this.curve.zeroA)return this.dbl().add(this);var xx=this.x.redSqr(),yy=this.y.redSqr(),zz=this.z.redSqr(),yyyy=yy.redSqr(),m=xx.redAdd(xx).redIAdd(xx),mm=m.redSqr();xx=this.x.redAdd(yy).redSqr().redISub(xx).redISub(yyyy);
xx=xx.redIAdd(xx);xx=xx.redAdd(xx).redIAdd(xx);xx=xx.redISub(mm);var ee=xx.redSqr();yyyy=yyyy.redIAdd(yyyy);yyyy=yyyy.redIAdd(yyyy);yyyy=yyyy.redIAdd(yyyy);yyyy=yyyy.redIAdd(yyyy);m=m.redIAdd(xx).redSqr().redISub(mm).redISub(ee).redISub(yyyy);yy=yy.redMul(m);yy=yy.redIAdd(yy);yy=yy.redIAdd(yy);yy=this.x.redMul(ee).redISub(yy);yy=yy.redIAdd(yy);yy=yy.redIAdd(yy);yyyy=this.y.redMul(m.redMul(yyyy.redISub(m)).redISub(xx.redMul(ee)));yyyy=yyyy.redIAdd(yyyy);yyyy=yyyy.redIAdd(yyyy);yyyy=yyyy.redIAdd(yyyy);
zz=this.z.redAdd(xx).redSqr().redISub(zz).redISub(ee);return this.curve.jpoint(yy,yyyy,zz)};JPoint.prototype.mul=function(k,kbase){k=new BN(k,kbase);return this.curve._wnafMul(this,k)};JPoint.prototype.eq=function(p){if("affine"===p.type)return this.eq(p.toJ());if(this===p)return!0;var z2=this.z.redSqr(),pz2=p.z.redSqr();if(0!==this.x.redMul(pz2).redISub(p.x.redMul(z2)).cmpn(0))return!1;z2=z2.redMul(this.z);pz2=pz2.redMul(p.z);return 0===this.y.redMul(pz2).redISub(p.y.redMul(z2)).cmpn(0)};JPoint.prototype.eqXToP=
function(x){var zs=this.z.redSqr(),rx=x.toRed(this.curve.red).redMul(zs);if(0===this.x.cmp(rx))return!0;x=x.clone();for(zs=this.curve.redN.redMul(zs);;){x.iadd(this.curve.n);if(0<=x.cmp(this.curve.p))return!1;rx.redIAdd(zs);if(0===this.x.cmp(rx))return!0}};JPoint.prototype.inspect=function(){return this.isInfinity()?"\x3cEC JPoint Infinity\x3e":"\x3cEC JPoint x: "+this.x.toString(16,2)+" y: "+this.y.toString(16,2)+" z: "+this.z.toString(16,2)+"\x3e"};JPoint.prototype.isInfinity=function(){return 0===
this.z.cmpn(0)}}
//# sourceMappingURL=module$node_modules$elliptic$lib$elliptic$curve$short.js.map
